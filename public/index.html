<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Strango • Chat with Stranger</title>

<script src="/socket.io/socket.io.js"></script>

<style>
:root{
  --bg: #1f1b18;
  --panel: #2a231f;
  --accent: #c89b6d;
  --accent-dark: #a67c52;
  --text: #f5f5f5;
  --muted: #b3b3b3;
}

*{box-sizing:border-box}

body{
  margin:0;
  height:100vh;
  font-family: system-ui, -apple-system, Segoe UI, Roboto;
  background: radial-gradient(circle at top, #2b241f, #161311);
  color: var(--text);
  display:flex;
  flex-direction:column;
}

header{
  padding:14px 20px;
  font-size:22px;
  font-weight:600;
  border-bottom:1px solid #3a302a;
}

#status{
  font-size:14px;
  color:var(--accent);
  margin-top:6px;
}

#chat{
  flex:1;
  padding:16px;
  overflow-y:auto;
}

.msg{
  margin-bottom:10px;
  line-height:1.4;
}

.you{ color:#9fd3ff }
.stranger{ color:#ffd59f }
.system{ color:var(--muted) }

#typing{
  font-size:13px;
  color:var(--muted);
  padding-left:16px;
  height:18px;
}

#controls{
  position:sticky;
  bottom:0;
  background: linear-gradient(to top, #1a1613, #1f1b18);
  padding:10px;
  display:flex;
  gap:10px;
  align-items:center;
}

#nextBtn{
  background:linear-gradient(135deg, #8b5e34, #c89b6d);
  border:none;
  color:#fff;
  padding:10px 16px;
  border-radius:10px;
  cursor:pointer;
  font-weight:600;
}

#nextBtn:hover{opacity:.9}

#input{
  flex:1;
  background:#2a231f;
  border:1px solid #3a302a;
  color:#fff;
  padding:12px;
  border-radius:10px;
  font-size:15px;
}

#sendBtn{
  background:linear-gradient(135deg, #5c3b24, #a67c52);
  border:none;
  color:#fff;
  padding:12px 18px;
  border-radius:10px;
  font-weight:600;
  cursor:pointer;
}

#sendBtn:hover{opacity:.9}
</style>
</head>

<body>

<header>
  Strango
  <div id="status">Connecting…</div>
</header>

<div id="chat"></div>
<div id="typing"></div>

<div id="controls">
  <button id="nextBtn">Next</button>
  <input id="input" placeholder="Type a message…" autocomplete="off"/>
  <button id="sendBtn">Send</button>
</div>

<script>
const socket = io();
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const sendBtn = document.getElementById("sendBtn");
const nextBtn = document.getElementById("nextBtn");
const status = document.getElementById("status");
const typing = document.getElementById("typing");

function addMsg(text, cls){
  const d = document.createElement("div");
  d.className = "msg " + cls;
  d.textContent = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

sendBtn.onclick = send;
input.addEventListener("keydown", e=>{
  if(e.key === "Enter") send();
  else socket.emit("typing");
});

nextBtn.onclick = ()=>{
  chat.innerHTML="";
  typing.textContent="";
  socket.emit("next");
  status.textContent="Connecting…";
};

function send(){
  const msg = input.value.trim();
  if(!msg) return;
  socket.emit("message", msg);
  addMsg("You: " + msg, "you");
  input.value="";
}

socket.on("connected", ()=>{
  status.textContent="Connected to a stranger";
  addMsg("Connected to a stranger", "system");
});

socket.on("message", msg=>{
  addMsg("Stranger: " + msg, "stranger");
});

socket.on("typing", ()=>{
  typing.textContent="Stranger is typing…";
  setTimeout(()=>typing.textContent="",1000);
});

socket.on("disconnected", ()=>{
  status.textContent="Stranger disconnected";
  addMsg("Stranger disconnected", "system");
});
</script>

</body>
</html>
