<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Strango â€” Free Anonymous Stranger Chat India</title>

<script src="/socket.io/socket.io.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}
body{background:#000;color:#fff;height:100vh;display:flex;flex-direction:column;}

.header{text-align:center;padding:20px 10px 10px;}
.subtitle{font-size:14px;opacity:.8;}

.main{
flex:1;
display:flex;
flex-direction:column;
max-width:900px;
margin:auto;
width:100%;
padding:0 10px 10px;
}

/* ===== TOP BAR ===== */
.top-bar{
display:flex;
justify-content:space-between;
align-items:center;
margin-bottom:4px;
}

.status{font-size:14px;}
.status.waiting{color:#ffd54f;}
.status.connected{color:#00ff88;}
.status.disconnected{color:#ff5252;}

.online{font-size:14px;}

/* typing text */
.typing{
font-size:12px;
color:#aaa;
height:16px;
margin-bottom:6px;
}

/* ===== CHAT ===== */
.chat-container{
flex:1;
display:flex;
flex-direction:column;
border:1px solid #111;
border-radius:12px;
background:#050505;
overflow:hidden;
}

.messages{
flex:1;
overflow-y:auto;
padding:15px;
display:flex;
flex-direction:column;
gap:10px;
}

.msg{padding:10px 14px;border-radius:18px;max-width:70%;font-size:14px;}
.you{background:#0f3d1f;align-self:flex-start;}
.stranger{background:#1b1b1b;align-self:flex-start;}

.input-bar{display:flex;border-top:1px solid #111;background:#000;}
.input-bar input{flex:1;background:#000;border:none;color:#fff;padding:14px;outline:none;}

.btn{border:none;padding:0 18px;font-weight:bold;cursor:pointer;}
.next{background:#ff4040;color:#fff;}
.send{background:#00c853;color:#fff;}

@media(max-width:600px){
.you{align-self:flex-end;}
.stranger{align-self:flex-start;}
}
</style>
</head>

<body>

<div class="header">
<h1>Strango</h1>
<div class="subtitle">Random Anonymous Chat â€¢ No Login â€¢ Fast Stranger Matching India</div>
</div>

<div class="main">

<div class="top-bar">
<div id="status" class="status waiting">âš¡ Waiting for stranger...</div>
<div id="online" class="online">ðŸ‘¤ 0</div>
</div>

<div id="typing" class="typing"></div>

<div class="chat-container">

<div class="messages" id="messages"></div>

<div class="input-bar">
<button class="btn next" id="nextBtn">NEXT</button>
<input id="messageInput" placeholder="Type a message..." />
<button class="btn send" id="sendBtn">SEND</button>
</div>

</div>
</div>

<script>
const socket = io();

const messages = document.getElementById("messages");
const input = document.getElementById("messageInput");
const status = document.getElementById("status");
const online = document.getElementById("online");
const typingText = document.getElementById("typing");

function addMessage(text,type){
const div=document.createElement("div");
div.className="msg "+type;
div.textContent=text;
messages.appendChild(div);
messages.scrollTop=messages.scrollHeight;
}

messages.innerHTML="";

/* STATUS COLORS */
socket.on("status",(msg)=>{

status.textContent="âš¡ "+msg;
typingText.textContent="";

status.classList.remove("waiting","connected","disconnected");

if(msg.toLowerCase().includes("waiting")){
status.classList.add("waiting");
}
else if(msg.toLowerCase().includes("connected")){
status.classList.add("connected");
}
else{
status.classList.add("disconnected");
}

});

/* ONLINE COUNT */
socket.on("onlineCount",(count)=>{
online.textContent="ðŸ‘¤ "+count;
});

/* RECEIVE MESSAGE */
socket.on("message",(msg)=>{
typingText.textContent="";
addMessage("Stranger: "+msg,"stranger");
});

/* TYPING INDICATOR */
socket.on("typing",(state)=>{
typingText.textContent = state ? "Stranger is typing..." : "";
});

/* SEND */
document.getElementById("sendBtn").onclick=()=>{
if(input.value.trim()){
addMessage("You: "+input.value,"you");
socket.emit("message",input.value);
socket.emit("typing",false);
input.value="";
}
};

/* INPUT TYPING EVENT */
let typingTimer;

input.addEventListener("input",()=>{
socket.emit("typing",true);

clearTimeout(typingTimer);
typingTimer=setTimeout(()=>{
socket.emit("typing",false);
},800);
});

/* NEXT */
document.getElementById("nextBtn").onclick=()=>{
messages.innerHTML="";
typingText.textContent="";
socket.emit("next");
};

input.addEventListener("keypress",(e)=>{
if(e.key==="Enter"){
document.getElementById("sendBtn").click();
}
});
</script>

</body>
</html>
