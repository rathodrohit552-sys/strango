<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Strango â€” Free Stranger Chat India</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;background:#000;color:#fff;font-family:sans-serif;}
.header{text-align:center;padding:40px 20px;}
.chat-box{height:55vh;overflow-y:auto;padding:15px;}
.msg{margin:8px 0;padding:10px;border-radius:10px;max-width:70%;}
.you{background:#4b5cff;margin-left:auto;}
.stranger{background:#333;}
.input-area{position:fixed;bottom:0;width:100%;display:flex;background:#111;padding:10px;}
#messageInput{flex:1;padding:12px;border-radius:25px;border:none;background:#222;color:#fff;}
button{margin-left:10px;border:none;padding:12px 20px;border-radius:25px;color:#fff;cursor:pointer;}
#nextBtn{background:orange;}
#sendBtn{background:green;}
.typing{font-size:14px;color:#aaa;padding-left:15px;}
</style>
</head>

<body>

<div class="header">
<h1>Strango â€” Free Stranger Chat India</h1>
<p>Anonymous text chat without login. Meet strangers instantly.</p>
</div>

<div id="statusText">ðŸŸ¡ Looking for stranger...</div>

<div id="chatBox" class="chat-box"></div>
<div id="typingText" class="typing"></div>

<div class="input-area">
<button id="nextBtn">Next</button>
<input id="messageInput" placeholder="Type a message..." disabled />
<button id="sendBtn" disabled>Send</button>
</div>

<script src="/socket.io/socket.io.js"></script>
<script>

const socket = io();

const chatBox = document.getElementById("chatBox");
const input = document.getElementById("messageInput");
const sendBtn = document.getElementById("sendBtn");
const nextBtn = document.getElementById("nextBtn");
const statusText = document.getElementById("statusText");
const typingText = document.getElementById("typingText");

let isMatched=false;

function enableChat(state){
isMatched=state;
input.disabled=!state;
sendBtn.disabled=!state;
}

function addMessage(text,type){
const div=document.createElement("div");
div.className="msg "+(type==="you"?"you":"stranger");
div.innerText=(type==="you"?"You: ":"Stranger: ")+text;
chatBox.appendChild(div);
chatBox.scrollTop=chatBox.scrollHeight;
}

sendBtn.onclick=()=>{
if(!isMatched)return;
const msg=input.value.trim();
if(!msg)return;
addMessage(msg,"you");
socket.emit("message",msg);
input.value="";
};

input.addEventListener("keypress",e=>{
if(e.key==="Enter")sendBtn.onclick();
});

input.addEventListener("input",()=>{
socket.emit("typing");
});

nextBtn.onclick=()=>{
chatBox.innerHTML="";
enableChat(false);
statusText.innerText="ðŸŸ¡ Looking for stranger...";
socket.emit("findStranger");
};

socket.on("waiting",()=>{
statusText.innerText="ðŸŸ¡ Waiting for stranger...";
enableChat(false);
});

socket.on("matched",()=>{
statusText.innerText="ðŸŸ¢ Connected to stranger";
enableChat(true);
});

socket.on("message",(msg)=>{
addMessage(msg,"stranger");
});

socket.on("typing",()=>{
typingText.innerText="Stranger is typing...";
setTimeout(()=>typingText.innerText="",1200);
});

socket.on("disconnectPartner",()=>{
statusText.innerText="ðŸ”´ Stranger disconnected";
enableChat(false);
});

socket.emit("findStranger");

</script>
</body>
</html>
