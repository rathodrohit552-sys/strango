<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strango — Free Stranger Chat India</title>

<style>
body{background:#000;color:#fff;font-family:Arial;text-align:center;margin:0;}
#online{color:#00ff9c;}
#status{color:#00ff9c;}

#chat{
  width:80%;
  height:45vh;
  margin:20px auto;
  border:1px solid #222;
  border-radius:14px;
  overflow-y:auto;
  padding:15px;
  background:#000;
  display:flex;
  flex-direction:column;
  align-items:flex-start;
}

.message{
  background:#333;
  color:#fff;
  padding:10px 14px;
  border-radius:14px;
  margin:6px 0;
  max-width:70%;
  text-align:left;
}

.you{background:#00e676;color:#000;}

#typing{
  font-size:13px;
  color:#aaa;
  margin-top:4px;
}

input{width:60%;padding:12px;border-radius:12px;border:none;}
button{padding:10px 16px;border-radius:12px;border:none;cursor:pointer;}
#send{background:#00e676;}
#next{background:#333;color:#fff;}

.footer-links{margin-top:15px;}
.footer-links a{color:#00e676;margin:0 6px;text-decoration:none;}
</style>
</head>

<body>

<h1>Strango — Free Stranger Chat India</h1>
<p>Anonymous text chat without login. Meet strangers instantly.</p>

<div id="online">Online: 0</div>
<div id="status">Looking for stranger...</div>

<div id="chat"></div>
<div id="typing"></div>

<div>
<button id="next">Next</button>
<input id="msg" placeholder="Type message...">
<button id="send">Send</button>
</div>

<div class="footer-links">
<a href="/privacy.html" target="_blank">Privacy</a> |
<a href="/terms.html" target="_blank">Terms</a> |
<a href="/safety.html" target="_blank">Safety</a> |
<a href="/about.html" target="_blank">About</a> |
<a href="/contact.html" target="_blank">Contact</a>
</div>

<script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>

<script>
document.addEventListener("DOMContentLoaded",()=>{

const socket = io("https://strango-1.onrender.com");

const chat=document.getElementById("chat");
const input=document.getElementById("msg");
const sendBtn=document.getElementById("send");
const nextBtn=document.getElementById("next");
const status=document.getElementById("status");
const online=document.getElementById("online");
const typingDiv=document.getElementById("typing");

let connected=false;
let typingTimeout=null;

// AUTO CONNECT
socket.emit("next");

socket.on("onlineCount",(c)=>{
 online.innerText="Online: "+c;
});

socket.on("waiting",()=>{
 connected=false;
 status.innerText="Looking for stranger...";
});

socket.on("strangerConnected",()=>{
 connected=true;
 status.innerText="Stranger connected";
});

socket.on("strangerDisconnected",()=>{
 connected=false;
 status.innerText="Stranger disconnected";
 typingDiv.innerText="";
});

socket.on("message",(msg)=>{
 addMsg("Stranger",msg);
 typingDiv.innerText="";
});

// ===== SHOW STRANGER TYPING =====
socket.on("strangerTyping",()=>{
 typingDiv.innerText="Stranger is typing...";
 clearTimeout(typingTimeout);
 typingTimeout=setTimeout(()=>{
   typingDiv.innerText="";
 },1500);
});

function sendMessage(){
 const text=input.value.trim();
 if(!text||!connected) return;

 socket.emit("message",text);
 addMsg("You",text);
 input.value="";
}

sendBtn.onclick=sendMessage;

input.addEventListener("keypress",(e)=>{
 if(e.key==="Enter"){
   e.preventDefault();
   sendMessage();
 }
});

// SEND TYPING SIGNAL
input.addEventListener("input",()=>{
 if(connected){
   socket.emit("typing");
 }
});

nextBtn.onclick=()=>{
 socket.emit("next");
 chat.innerHTML="";
 typingDiv.innerText="";
};

function addMsg(sender,text){
 const div=document.createElement("div");
 div.classList.add("message");
 if(sender==="You"){div.classList.add("you");}
 div.innerText=sender+": "+text;
 chat.appendChild(div);
 chat.scrollTop=chat.scrollHeight;
}

});
</script>

</body>
</html>
