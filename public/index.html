<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Strango</title>
<script src="/socket.io/socket.io.js"></script>

<style>
body {
  margin: 0;
  font-family: Inter, system-ui, sans-serif;
  background: linear-gradient(135deg, #2b1b17, #3e2723);
  color: #fff;
}

#chat {
  padding: 20px;
  height: 80vh;
  overflow-y: auto;
}

input {
  width: 70%;
  padding: 14px;
  border-radius: 10px;
  border: none;
  outline: none;
}

button {
  padding: 14px 22px;
  border-radius: 12px;
  border: none;
  font-weight: 600;
  cursor: pointer;
  transition: 0.2s;
}

#send {
  background: linear-gradient(135deg, #ff9800, #ff5722);
  color: white;
}

#next {
  background: linear-gradient(135deg, #8e24aa, #5e35b1);
  color: white;
}

button:hover {
  transform: scale(1.05);
}

#status {
  padding: 10px;
  color: #9cffb0;
}

#typing {
  font-size: 13px;
  opacity: 0.7;
}
</style>
</head>

<body>

<h2 style="padding:10px;">Strango</h2>
<div id="status">Connecting...</div>
<div id="chat"></div>
<div id="typing"></div>

<div style="padding:10px;">
  <input id="msg" placeholder="Type a message..." />
  <button id="send">Send</button>
  <button id="next">Next</button>
</div>

<script>
const socket = io();
const chat = document.getElementById("chat");
const msg = document.getElementById("msg");
const status = document.getElementById("status");
const typing = document.getElementById("typing");

socket.emit("find");

socket.on("connected", () => {
  status.innerText = "Connected to a stranger";
});

socket.on("disconnected", () => {
  status.innerText = "Disconnected. Finding new stranger...";
  chat.innerHTML = "";
});

socket.on("message", (m) => {
  chat.innerHTML += `<div><b>Stranger:</b> ${m}</div>`;
  typing.innerText = "";
});

socket.on("typing", () => {
  typing.innerText = "Stranger is typing...";
  setTimeout(() => typing.innerText = "", 1000);
});

document.getElementById("send").onclick = sendMessage;

msg.addEventListener("keydown", (e) => {
  if (e.key === "Enter") sendMessage();
  else socket.emit("typing");
});

function sendMessage() {
  if (!msg.value.trim()) return;
  chat.innerHTML += `<div><b>You:</b> ${msg.value}</div>`;
  socket.emit("message", msg.value);
  msg.value = "";
}

document.getElementById("next").onclick = () => {
  socket.emit("next");
};
</script>

</body>
</html>
