<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Strango — Free Stranger Chat India</title>

<style>

body{margin:0;font-family:Arial;background:#000;color:#fff;}

h1{text-align:center;margin:10px 0 5px 0;font-size:28px;}
.subtitle{text-align:center;font-size:14px;margin:0;color:#ccc;}
.online{text-align:center;color:#00ff7b;margin-top:5px;}

.main-container{
 width:95%;max-width:1200px;margin:15px auto;
 display:flex;gap:20px;
}

.left-panel{flex:65%;}
.right-panel{flex:35%;}

.chat-box{
 background:#0f0f0f;border-radius:14px;padding:15px;
 height:65vh;overflow-y:auto;
}

.message{
 margin:6px 0;padding:8px 12px;border-radius:10px;
 width:fit-content;max-width:80%;
}

.stranger{background:#1a1a1a;}
.me{background:#25D366;color:#000;}
.status{background:#222;color:#bbb;font-size:13px;}

.controls{margin-top:10px;display:flex;gap:10px;}

input{
 flex:1;padding:10px;border-radius:8px;border:none;
}

.send-btn{
 background:#00ff7b;border:none;padding:10px 14px;border-radius:8px;
}
.next-btn{
 background:#7B3F00;color:#fff;border:none;padding:10px 14px;border-radius:8px;
}

.utilities{
 background:#0d0d0d;padding:20px;border-radius:14px;
}

</style>
</head>

<body>

<h1>Strango — Free Stranger Chat India</h1>
<p class="subtitle">Anonymous text chat without login. Meet strangers instantly.</p>
<div class="online">Online: <span id="onlineCount">0</span></div>

<div class="main-container">

<div class="left-panel">

<div id="chat" class="chat-box"></div>

<div class="controls">
<button class="next-btn" onclick="nextStranger()">Next</button>
<input id="messageInput" placeholder="Type message..." />
<button class="send-btn" onclick="sendMessage()">Send</button>
</div>

</div>

<div class="right-panel">
<div class="utilities">
<h3>Strango Utilities</h3>
<ul>
<li>Private anonymous chat</li>
<li>No login required</li>
<li>Global random matching</li>
<li>Fast lightweight design</li>
<li>Mobile friendly</li>
</ul>
</div>
</div>

</div>

<script src="/socket.io/socket.io.js"></script>
<script>

const socket=io();
const chat=document.getElementById("chat");
const input=document.getElementById("messageInput");

let connected=false;
let statusDiv=null;
let iClickedNext=false;

/* CLEAR CHAT */
function clearChat(){
 chat.innerHTML="";
 statusDiv=null;
}

/* ADD MESSAGE */
function addMessage(text,type="stranger"){

 if(type==="status"){
   if(statusDiv){
     statusDiv.innerText=text;
     return;
   }
   statusDiv=document.createElement("div");
   statusDiv.className="message status";
   statusDiv.innerText=text;
   chat.appendChild(statusDiv);
   return;
 }

 const div=document.createElement("div");
 div.className="message "+type;
 div.innerText=text;
 chat.appendChild(div);
 chat.scrollTop=chat.scrollHeight;
}

/* SEND */
function sendMessage(){

 if(!connected){
   addMessage("⚠️ Not connected yet","status");
   return;
 }

 if(!input.value.trim())return;

 const msg=input.value;

 socket.emit("message",msg);
 addMessage("You: "+msg,"me");

 input.value="";
}

/* ⭐ ENTER KEY SEND */
input.addEventListener("keydown",function(e){

  if(e.key==="Enter" && !e.shiftKey){
     e.preventDefault();   // stop newline
     sendMessage();
  }

});

/* NEXT */
function nextStranger(){
 iClickedNext=true;
 connected=false;
 clearChat();
 socket.emit("next");
 addMessage("Looking for new stranger...","status");
}

/* SOCKET EVENTS */

socket.on("connect",()=>{
 addMessage("Looking for stranger...","status");
});

socket.on("status",msg=>{

 if(msg.toLowerCase().includes("connected")){
   connected=true;
   iClickedNext=false;
 }

 if(msg.toLowerCase().includes("disconnected")){
   connected=false;

   if(iClickedNext){
     clearChat();
   }
 }

 addMessage(msg,"status");
});

socket.on("message",msg=>{
 addMessage("Stranger: "+msg,"stranger");
});

socket.on("online",count=>{
 document.getElementById("onlineCount").innerText=count;
});

</script>

</body>
</html>
